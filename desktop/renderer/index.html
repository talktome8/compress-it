<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Compress-It</title>
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app">
      <!-- Title Bar (draggable) -->
      <div class="titlebar">
        <div class="titlebar-text">
          <svg
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
            <circle cx="8.5" cy="8.5" r="1.5" />
            <polyline points="21,15 16,10 5,21" />
          </svg>
          Compress-It Desktop
        </div>
      </div>

      <!-- Mode Tabs -->
      <div class="tabs">
        <button
          class="tab active"
          data-mode="images"
          onclick="switchMode('images')"
        >
          <svg
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
            <circle cx="8.5" cy="8.5" r="1.5" />
            <polyline points="21,15 16,10 5,21" />
          </svg>
          Images
        </button>
        <button class="tab" data-mode="videos" onclick="switchMode('videos')">
          <svg
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polygon points="23,7 16,12 23,17" />
            <rect x="1" y="5" width="15" height="14" rx="2" ry="2" />
          </svg>
          Videos
        </button>
      </div>

      <!-- ===== IMAGE MODE ===== -->
      <div id="imageMode" class="mode-content active">
        <!-- Drop zone -->
        <div class="dropzone" id="imageDropzone">
          <svg
            width="48"
            height="48"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
            <polyline points="17,8 12,3 7,8" />
            <line x1="12" y1="3" x2="12" y2="15" />
          </svg>
          <h3>Drop images here or click to browse</h3>
          <p>JPG, PNG, GIF, WebP • No size limits • Unlimited files</p>
        </div>

        <!-- Image Settings (hidden until files added) -->
        <div id="imageSettings" class="settings-panel" style="display: none">
          <div class="settings-row">
            <div class="setting">
              <label>Quality: <span id="qualityVal">80</span>%</label>
              <input
                type="range"
                id="qualitySlider"
                min="1"
                max="100"
                value="80"
                class="slider"
              />
              <div class="slider-labels">
                <span>Smaller</span><span>Better</span>
              </div>
            </div>
            <div class="setting">
              <label>Format</label>
              <select id="outputFormat" class="select">
                <option value="original">Keep Original</option>
                <option value="jpeg">JPEG</option>
                <option value="png">PNG</option>
                <option value="webp">WebP (Best)</option>
              </select>
            </div>
          </div>

          <!-- File list -->
          <div id="imageFileList" class="file-list"></div>

          <div class="actions">
            <button
              class="btn btn-primary btn-large"
              onclick="compressAllImages()"
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="4,14 10,14 10,20" />
                <polyline points="20,10 14,10 14,4" />
                <line x1="14" y1="10" x2="21" y2="3" />
                <line x1="3" y1="21" x2="10" y2="14" />
              </svg>
              Compress All
            </button>
            <button class="btn btn-secondary" onclick="clearImages()">
              Clear
            </button>
          </div>
        </div>

        <!-- Image Results -->
        <div id="imageResults" style="display: none">
          <div class="results-summary-bar">
            <div class="stat-group">
              <span class="stat-label">Original</span>
              <span class="stat-value" id="imgOrigSize">—</span>
            </div>
            <span class="stat-arrow">→</span>
            <div class="stat-group">
              <span class="stat-label">Compressed</span>
              <span class="stat-value" id="imgCompSize">—</span>
            </div>
            <div class="stat-group highlight">
              <span class="stat-label">Saved</span>
              <span class="stat-value" id="imgSaved">—</span>
            </div>
            <div class="stat-actions">
              <button class="btn btn-primary" onclick="saveAllImages()">
                Save All
              </button>
              <button class="btn btn-secondary" onclick="clearImages()">
                New Batch
              </button>
            </div>
          </div>
          <div id="imageResultsGrid" class="results-grid"></div>
        </div>

        <!-- Progress -->
        <div
          id="imageProgress"
          class="progress-bar-container"
          style="display: none"
        >
          <div class="progress-label">
            <span id="imgProgressLabel">Compressing...</span>
            <span id="imgProgressCount"></span>
          </div>
          <div class="progress-track">
            <div class="progress-fill" id="imgProgressFill"></div>
          </div>
        </div>
      </div>

      <!-- ===== VIDEO MODE ===== -->
      <div id="videoMode" class="mode-content">
        <!-- Drop zone -->
        <div class="dropzone" id="videoDropzone">
          <svg
            width="48"
            height="48"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <polygon points="23,7 16,12 23,17" />
            <rect x="1" y="5" width="15" height="14" rx="2" ry="2" />
          </svg>
          <h3>Drop a video here or click to browse</h3>
          <p>MP4, MOV, AVI, MKV, WebM • No size limits</p>
          <div class="speed-badge">
            ⚡ Native FFmpeg — 10-20x faster than browser
          </div>
        </div>

        <!-- Video Settings -->
        <div id="videoSettings" class="settings-panel" style="display: none">
          <div class="video-file-info-bar">
            <div class="vfi-name" id="vFileName">—</div>
            <div class="vfi-meta">
              <span id="vFileSize">—</span>
              <span>•</span>
              <span id="vFileDuration">—</span>
              <span>•</span>
              <span id="vFileRes">—</span>
            </div>
            <button class="btn btn-text btn-sm" onclick="clearVideo()">
              ✕ Remove
            </button>
          </div>

          <div class="settings-row">
            <div class="setting">
              <label>Target Size</label>
              <select id="videoTargetSize" class="select">
                <option value="16">16 MB (Discord)</option>
                <option value="25">25 MB (Email)</option>
                <option value="50">50 MB (WhatsApp status)</option>
                <option value="100">100 MB</option>
                <option value="180" selected>180 MB (WhatsApp)</option>
                <option value="256">256 MB</option>
                <option value="500">500 MB</option>
                <option value="custom">Custom...</option>
              </select>
            </div>
            <div class="setting" id="customSizeGroup" style="display: none">
              <label>Custom Size (MB)</label>
              <input
                type="number"
                id="videoCustomSize"
                class="input"
                placeholder="200"
                min="1"
              />
            </div>
            <div class="setting">
              <label>Quality</label>
              <select id="videoQuality" class="select">
                <option value="high">Best Quality</option>
                <option value="medium" selected>Balanced (recommended)</option>
                <option value="low">Fastest</option>
              </select>
            </div>
            <div class="setting">
              <label>Format</label>
              <select id="videoFormat" class="select">
                <option value="mp4" selected>MP4</option>
                <option value="webm">WebM</option>
              </select>
            </div>
          </div>

          <div class="privacy-note">
            <svg
              width="14"
              height="14"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
              <path d="M7 11V7a5 5 0 0 1 10 0v4" />
            </svg>
            100% Offline — Everything stays on your computer. Nothing is
            uploaded anywhere.
          </div>

          <div class="actions">
            <button
              class="btn btn-primary btn-large"
              id="videoCompressBtn"
              onclick="compressVideo()"
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="4,14 10,14 10,20" />
                <polyline points="20,10 14,10 14,4" />
                <line x1="14" y1="10" x2="21" y2="3" />
                <line x1="3" y1="21" x2="10" y2="14" />
              </svg>
              Compress Video
            </button>
          </div>
        </div>

        <!-- Video Progress -->
        <div
          id="videoProgress"
          class="progress-bar-container"
          style="display: none"
        >
          <div class="progress-label">
            <span id="vidProgressLabel">Compressing...</span>
            <span id="vidProgressPercent">0%</span>
          </div>
          <div class="progress-track">
            <div class="progress-fill" id="vidProgressFill"></div>
          </div>
          <div class="progress-detail">
            <span id="vidProgressSpeed">—</span>
            <button class="btn btn-text btn-sm" onclick="cancelVideo()">
              Cancel
            </button>
          </div>
        </div>

        <!-- Video Result -->
        <div id="videoResult" class="result-card" style="display: none">
          <h3>✅ Compression Complete!</h3>
          <div class="results-summary-bar">
            <div class="stat-group">
              <span class="stat-label">Original</span>
              <span class="stat-value" id="vidOrigSize">—</span>
            </div>
            <span class="stat-arrow">→</span>
            <div class="stat-group">
              <span class="stat-label">Compressed</span>
              <span class="stat-value" id="vidCompSize">—</span>
            </div>
            <div class="stat-group highlight">
              <span class="stat-label">Saved</span>
              <span class="stat-value" id="vidSaved">—</span>
            </div>
          </div>
          <div class="actions">
            <button class="btn btn-primary" onclick="openVideoFile()">
              Open in Folder
            </button>
            <button class="btn btn-secondary" onclick="clearVideo()">
              Compress Another
            </button>
          </div>
        </div>
      </div>

      <!-- Toast container -->
      <div id="toastContainer" class="toast-container"></div>
    </div>

    <script src="js/app.js"></script>
  </body>
</html>
